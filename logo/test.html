<html>
<head>
<meta charset="utf-8">
<script src="data/vocabulary.js"></script>
<script src="data/abc.js"></script>
<script>
var gData = [];

String.prototype.norm = function(s, r) {return this.split("-").join("");}

function libShuffle(arr)
{
  var count = arr.length * 32;
  for(var i = 0; i < count; i ++)
  {
    var i1 = Math.floor(Math.random() * 10000) % arr.length;
    var i2 = Math.floor(Math.random() * 10000) % arr.length;
    var tmp = arr[i1];
    arr[i1] = arr[i2];
    arr[i2] = tmp;
  }
}

function libGetAllSyll()
{
  var arr = [];
  var tmp = [];
  for(var i = 0; i < gData.length; i ++)
  {
    var arr1 = gData[i].txt.split('-');
    if(arr1.length == 1) continue;
    for(var j = 0; j < arr1.length; j ++)
    {
      if(tmp[arr1[j]] != null) continue;
      tmp[arr1[j]] = "";
      arr.push(arr1[j]);
    }
  }
  libShuffle(arr);
  return arr;
}

function libBackGround(clr0, clr1)
{
  // Create gradient
  var grd = gData.ctx.createLinearGradient(0,0,cs.width,cs.height);
  grd.addColorStop(0, clr0);
  grd.addColorStop(1, clr1);

  // Fill with gradient
  gData.ctx.fillStyle = grd;
  gData.ctx.fillRect(0, 0, cs.width, cs.height);
}

function libDrawImgWithText(img, txt)
{
    var lineHeight = img.height / 5;
    gData.ctx.font = lineHeight + 'pt Calibri';
    var x = cs.width / 2 - img.width / 2;
    var y = cs.height / 20;
    imgTop = y;
    gData.ctx.drawImage(img, x, y);
    y += img.height;
    y += cs.height / 40;
    y += lineHeight;
    gData.ctx.fillStyle = 'darkblue';
    x = cs.width / 2 - gData.ctx.measureText(txt).width / 2;
    gData.ctx.fillText(txt, x, y);
}

libDrawObjects = function(img, left, right, curr)
{
  var cnt = left;
  var cx = 1;
  var cy = Math.ceil(cnt / cx);
  while(cx < (cy = Math.ceil(cnt / cx))) cx ++;
  var ww = img.width / 3;
  var hh = img.height / 3;
  var y = cs.height / 4 - hh * cy / 2;
  for(var cyy = 0; cyy < cy && cnt; cyy++)
  {
    var x = cs.width / 4 - ww * cx / 2;
    for(var cxx = 0; cxx < cx && cnt; cxx ++)
    {
      gData.ctx.drawImage(img, x, y, ww, hh);
      x += ww;
      cnt --;
    }
    y += hh;
  }
  var ty = y;

  var cnt = right;
  var cx = 1;
  var cy = Math.ceil(cnt / cx);
  while(cx < (cy = Math.ceil(cnt / cx))) cx ++;
  var y = cs.height / 4 - hh * cy / 2;
  for(var cyy = 0; cyy < cy && cnt; cyy++)
  {
    var x = cs.width / 4 - ww * cx / 2;
    var x = cs.width - cs.width / 4 - ww * cx / 2;
    for(var cxx = 0; cxx < cx && cnt; cxx ++)
    {
      gData.ctx.drawImage(img, x, y, ww, hh);
      x += ww;
      cnt --;
    }
    y += hh;
  }
  ty = Math.max(ty, y);
  ty += cs.height / 5;
  gData.ctx.save();
  gData.ctx.font = cs.width / 27 + 'pt Calibri';
  gData.ctx.fillStyle = 'darkblue';
  gData.ctx.fillText(curr, cs.width / 2 - gData.ctx.measureText(curr).width / 2, ty);
  gData.ctx.restore();
}

libDrawNumSignPad = function()
{
  var hh = cs.width / 27; //10 numbers + 3 signs + spaces
  var y = cs.height - 10;
  var x = 0;
  gData.ctx.font = hh + 'pt Calibri';
  gData.ctx.fillStyle = 'darkblue';
  var arr = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, '<', '=', '>'];
  for(var i in arr)
  {
    x += hh;
    gData.ctx.fillText(arr[i], x, y);
    x += hh;
  }
}

function numSoundScreen()
{
  var x0;
  var y0;
  var hh;
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    hh = Math.min(cs.width, cs.height) / 10;
    gData.ctx.font = hh + "pt Calibri";
    x0 = (cs.width - 7 * hh) / 2;
    y0 = (cs.height - 9 * hh) / 2;
    gData.ctx.fillStyle = "darkblue";
    var y = y0;
    var k = 1;
    for(var j = 0; j < 3; j ++)
    {
      var x = x0;
      y += hh;
      for(var i = 0; i < 3; i ++)
      {
        x += hh;
        gData.ctx.fillText(k++, x, y);
        x += hh;
      }
      y += hh;
    }
    y += hh;
    gData.ctx.fillText(k++, x0 + hh, y);
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var ex = e.clientX - rc.left;
    var ey = e.clientY - rc.top;
    var y = y0;
    var y1 = 0;
    var x = 0;
    var x1 = 0;
    for(var j = 0; j < 3; j ++, y = y1)
    {
      x = x0 + hh / 2;
      y1 = y + 2 * hh;
      if(ey < y || ey > y1) continue;
      for(var i = 0; i < 3; i ++, x = x1)
      {
        x1 = x + 2 * hh;
        if(ex < x || ex > x1) continue;
        var audio = new Audio("sound/" + (1 + i + 3 * j) + ".mp3");
        audio.play();
        return;
      }
    }
    x = x0 + hh / 2;
    x1 = x + 2.5 * hh;
    y1 = y + 2 * hh;
    if(ey >= y && ey <= y1 && ex >= x && ex <= x1) {
      var audio = new Audio("sound/10.mp3");
      audio.play();
      return;
    }
  }
  draw();
}

function compScreenNum(mn, mx, update)
{
  var curr = "";
  if(update)
  {
    var eq = 0 == Math.floor(Math.random() * 10000) % 3;
    left = mn + Math.floor(Math.random() * 10000) % (mx - mn + 1);
    right = eq ? left : mn + Math.floor(Math.random() * 10000) % (mx - mn + 1);
    sign = '=';
    if(left < right) sign = '<';
    if(left > right) sign = '>';
    display = left + sign + right;
    var numgData = [];
    for(var i = 0; i < gData.length; i ++) if(gData[i].num) numgData.push(gData[i]);
    currImg = numgData[Math.floor(Math.random() * 10000) % numgData.length];
  }
  correct = left + " " + right + sign;
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    gData.ctx.drawImage(gData.refresh, 0, 0);
    libDrawObjects(currImg, left, right, curr);
    libDrawNumSignPad();
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(x < gData.refresh.width && y < gData.refresh.height) return compScreenNum(mn, mx, true);
    var hh = cs.width / 27; //10 numbers + 3 signs + spaces
    if(y < cs.height - 10 - hh) return;
    var idx = Math.floor((x - hh / 2)/ 2 / hh);
    var arr = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, '<', '=', '>'];
    if(correct.charAt(0) == " ")
    {
      curr += "   ";
      correct = correct.substring(1);
    }
    if(correct.charAt(0) == arr[idx])
    {
      curr += arr[idx];
      correct = correct.substring(1);
    }
    else {return noScreen();}
    if(correct === "") return yesScreen();
    draw();
    return;
  }
  yesScreen = function()
  {
    draw = function()
    {
      gData.ctx.save();
      libBackGround("red", "yellow");
      var hh = cs.height / 5;
      gData.ctx.font = hh + 'pt Calibri';
      gData.ctx.fillStyle = 'darkblue';
      gData.ctx.fillText(display, cs.width / 2 - gData.ctx.measureText(display).width / 2, cs.height / 2);
      libDrawObjects(currImg, left, right, "");
      gData.ctx.restore();
    }
    onclick_ = function(e) {compScreenNum(mn, mx, true);}
    draw();
  }
  noScreen = function(sign)
  {
    draw = function()
    {
      gData.ctx.save();
      libBackGround("red", "yellow");
      gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - gData.no.height / 2);

      gData.ctx.restore();
    }
    onclick_ = function(e) {compScreenNum(mn, mx, false);}
    draw();
  }
  draw();
}

function compScreen(mn, mx, update)
{
  if(update)
  {
    operArr = ['<', '=', '>'];
    libShuffle(operArr);
    var eq = 0 == Math.floor(Math.random() * 10000) % 3;
    left = mn + Math.floor(Math.random() * 10000) % (mx - mn + 1);
    right = eq ? left : mn + Math.floor(Math.random() * 10000) % (mx - mn + 1);
    currTxt = '=';
    if(left < right) currTxt = '<';
    if(left > right) currTxt = '>';
    var numgData = [];
    for(var i = 0; i < gData.length; i ++) if(gData[i].num) numgData.push(gData[i]);
    currImg = numgData[Math.floor(Math.random() * 10000) % numgData.length];
  }
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    gData.ctx.drawImage(gData.refresh, 0, 0);
    var hh = cs.height / 10;
    var ww = cs.width / 4 - hh / 2;
    
    var y = cs.height - hh;
    gData.ctx.font = hh + 'pt Calibri';
    gData.ctx.fillStyle = 'darkblue';
    gData.ctx.fillText(operArr[0], cs.width / 4 - hh / 2, y);
    gData.ctx.fillText(operArr[1], cs.width / 2 - hh / 2, y);
    gData.ctx.fillText(operArr[2], cs.width - cs.width / 4 - hh / 2, y);
    libDrawObjects(currImg, left, right, '');
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(x < gData.refresh.width && y < gData.refresh.height) return compScreen(mn, mx, true);
    var hh = cs.height / 10;
    var ww = cs.width / 4;
    if(y < cs.height - 3 * hh) return;
    var vx = ww / 2;
    if(x < vx) {return};
    vx += ww;
    if(x < vx) {return operArr[0] == currTxt ? compYesScreen() : compNoScreen(operArr[0]);}
    vx += ww;
    if(x < vx) {return operArr[1] == currTxt ? compYesScreen() : compNoScreen(operArr[1]);}
    vx += ww;
    if(x < vx) {return operArr[2] == currTxt ? compYesScreen() : compNoScreen(operArr[2]);}
    return;
  }
  compYesScreen = function()
  {
    draw = function()
    {
      gData.ctx.save();
      libBackGround("red", "yellow");
      var hh = cs.height / 5;
      var x = cs.width / 2 - hh / 2;
      var y = cs.height / 4 + hh / 2;
      gData.ctx.font = hh + 'pt Calibri';
      gData.ctx.fillStyle = 'darkblue';
      gData.ctx.fillText(currTxt, x, y);
      libDrawObjects(left, right, '');
      gData.ctx.restore();
    }
    onclick_ = function(e) {compScreen(mn, mx, true);}
    draw();
  }
  compNoScreen = function(sign)
  {
    draw = function()
    {
      gData.ctx.save();
      libBackGround("red", "yellow");
      gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - cs.height / 5 / 2);
      gData.ctx.restore();
    }
    onclick_ = function(e) {compScreen(mn, mx, false);}
    draw();
  }
  draw();
}

function numberScreen(update)
{
  if(update)
  {
    var numgData = [];
    for(var i = 0; i < gData.length; i ++) if(gData[i].num) numgData.push(gData[i]);
    while(true)
    {
      currImg = numgData[Math.floor(Math.random() * 10000) % numgData.length];
      if(currImg.txt.split('-').length > 1) break;
    }
    currTxt = "";
    var tmp = [];
    var arr = [];
    var syllArr = currImg.txt.split('-').concat(libGetAllSyll());
    for(var i = 0; arr.length < 7 && i < syllArr.length; i ++)
    {
      if(tmp[syllArr[i]] != null) continue;
      tmp[syllArr[i]] = "";
      arr.push(syllArr[i]);
    }
    libShuffle(arr);
    currTxtArr = arr;
  }
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    libDrawImgWithText(currImg, currTxt);
    var lineHeight = cs.width / currTxtArr.join("").length / 2;
    gData.ctx.font = lineHeight + 'pt Calibri';
    var y = cs.height - cs.height / 20;
    var step = cs.width - gData.ctx.measureText(currTxtArr.join()).width;
    step /= (2 * currTxtArr.length);
    var x = 0;
    txtGrid = [];
    for(var i = 0; i < currTxtArr.length; i ++)
    {
      var width = gData.ctx.measureText(currTxtArr[i]).width;
      x += step;
      txtGrid[i] = {"x":x,"y":y - lineHeight - cs.height / 20,"w":width};
      gData.ctx.fillText(currTxtArr[i], x, y);
      x += width;
      x += step;
    }
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(y < imgTop + currImg.height) {return numberScreen(true);}
    for(var i = 0; i < txtGrid.length; i ++)
    {
      var s = txtGrid[i];
      if((x >= s.x) && (x <= s.x + s.w) && (y >= s.y))
      {
        var syll = currTxtArr[i];
        currTxt += syll;
        if(currTxt === currImg.txt.norm())
        {
          draw = function()
          {
            gData.ctx.save();
            libBackGround("red", "yellow");
            var lineHeight = 20;
            var txt = currImg.txt.norm();
            gData.ctx.font = lineHeight + 'pt Calibri';
            var txtWidth = gData.ctx.measureText(txt).width;
            lineHeight *= currImg.width;
            lineHeight /= txtWidth;
            gData.ctx.font = lineHeight + 'pt Calibri';
            var x = cs.width / 2 - currImg.width / 2;
            var y = cs.height / 2 - currImg.height / 2 - (lineHeight + 10) / 2;
            gData.ctx.drawImage(currImg, x, y);
            gData.ctx.fillStyle = 'darkblue';
            gData.ctx.fillText(txt, x, y + currImg.height + lineHeight + 10);
            gData.ctx.restore();
          }
          onclick_ = function(e) {numberScreen(true);}
          draw();
          return;
        }
        if(currImg.txt.norm().indexOf(currTxt) != 0)
        {
          currTxt = "";
          draw = function()
          {
            gData.ctx.save();
            libBackGround("red", "yellow");
            gData.ctx.drawImage(currImg, cs.width / 2 - currImg.width / 2, cs.height / 2 - currImg.height / 2);
            gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - gData.no.height / 2);
            gData.ctx.restore();
          }
          onclick_ = function(e) {numberScreen(false);}
          draw();
          return;
        }
      }
    }
    draw();
  }
  draw();
}

function syllableScreen(update)
{
  if(update)
  {
    while(true)
    {
      currImg = gData[Math.floor(Math.random() * 10000) % gData.length];
      if(currImg.txt.split('-').length > 1) break;
    }
    currTxt = "";
    var tmp = [];
    var arr = [];
    var syllArr = currImg.txt.split('-').concat(libGetAllSyll());
    for(var i = 0; arr.length < 7 && i < syllArr.length; i ++)
    {
      if(tmp[syllArr[i]] != null) continue;
      tmp[syllArr[i]] = "";
      arr.push(syllArr[i]);
    }
    libShuffle(arr);
    currTxtArr = arr;
  }
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    libDrawImgWithText(currImg, currTxt);
    var lineHeight = cs.width / currTxtArr.join("").length / 2;
    gData.ctx.font = lineHeight + 'pt Calibri';
    var y = cs.height - cs.height / 20;
    var step = cs.width - gData.ctx.measureText(currTxtArr.join()).width;
    step /= (2 * currTxtArr.length);
    var x = 0;
    txtGrid = [];
    for(var i = 0; i < currTxtArr.length; i ++)
    {
      var width = gData.ctx.measureText(currTxtArr[i]).width;
      x += step;
      txtGrid[i] = {"x":x,"y":y - lineHeight - cs.height / 20,"w":width};
      gData.ctx.fillText(currTxtArr[i], x, y);
      x += width;
      x += step;
    }
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(y < imgTop + currImg.height) {return syllableScreen(true);}
    for(var i = 0; i < txtGrid.length; i ++)
    {
      var s = txtGrid[i];
      if((x >= s.x) && (x <= s.x + s.w) && (y >= s.y))
      {
        var syll = currTxtArr[i];
        currTxt += syll;
        if(currTxt === currImg.txt.norm())
        {
          draw = function()
          {
            gData.ctx.save();
            libBackGround("red", "yellow");
            var lineHeight = 20;
            var txt = currImg.txt.norm();
            gData.ctx.font = lineHeight + 'pt Calibri';
            var txtWidth = gData.ctx.measureText(txt).width;
            lineHeight *= currImg.width;
            lineHeight /= txtWidth;
            gData.ctx.font = lineHeight + 'pt Calibri';
            var x = cs.width / 2 - currImg.width / 2;
            var y = cs.height / 2 - currImg.height / 2 - (lineHeight + 10) / 2;
            gData.ctx.drawImage(currImg, x, y);
            gData.ctx.fillStyle = 'darkblue';
            gData.ctx.fillText(txt, x, y + currImg.height + lineHeight + 10);
            gData.ctx.restore();
          }
          onclick_ = function(e) {syllableScreen(true);}
          draw();
          return;
        }
        if(currImg.txt.norm().indexOf(currTxt) != 0)
        {
          currTxt = "";
          draw = function()
          {
            gData.ctx.save();
            libBackGround("red", "yellow");
            gData.ctx.drawImage(currImg, cs.width / 2 - currImg.width / 2, cs.height / 2 - currImg.height / 2);
            gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - gData.no.height / 2);
            gData.ctx.restore();
          }
          onclick_ = function(e) {syllableScreen(false);}
          draw();
          return;
        }
      }
    }
    draw();
  }
  draw();
}

function letterScreen(update)
{
  if(update)
  {
    currImg = gData[Math.floor(Math.random() * 10000) % gData.length];
    currTxt = "";
    var tmp = [];
    var arr = [];
    var txt = currImg.txt.norm();
    for(var i = 0; i < txt.length; i ++)
    {
      var ch = txt.charAt(i);
      if(ch == "ո" && txt.charAt(i + 1) == "ւ") {ch = "ու"; i ++;}
      else if(ch == "Ո" && txt.charAt(i + 1) == "Ւ") {ch = "ՈՒ"; i ++;}
      if(ch === ch.toUpperCase())
      {
        if(tmp[ch.toLowerCase()] == null)
        {
          tmp[ch.toLowerCase()] = "";
          arr.push(ch.toLowerCase());
        }
      }
      if(tmp[ch] != null) continue;
      tmp[ch] = "";
      arr.push(ch);
    }
    var count = arr.length * 2;
    if(count < 7) count = 7;
    var i = arr.length;
    while(arr.length < count)
    {
      var ch = g_abc[Math.floor(Math.random() * 10000) % g_abc.length];
      if(tmp[ch] != null) continue;
      tmp[ch] = "";
      arr.push(ch);
    }
    libShuffle(arr);
    currTxtArr = arr;
  }
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    libDrawImgWithText(currImg, currTxt);
    var lineHeight = cs.width / currTxtArr.length / 2;
    gData.ctx.font = lineHeight + 'pt Calibri';
    var y = cs.height - cs.height / 20;
    var x = 0;
    for(var i = 0; i < currTxtArr.length; i ++)
    {
      gData.ctx.fillText(currTxtArr[i], x + lineHeight - gData.ctx.measureText(currTxtArr[i]).width / 2, y);
      x += 2 * lineHeight;
    }
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(y < imgTop + currImg.height) {return letterScreen(true);}
    var lineHeight = cs.width / currTxtArr.length / 2;
    if(y < cs.height - cs.height / 10 - lineHeight) return;
    var ch = currTxtArr[Math.floor(x / (2 * lineHeight))];
    currTxt += ch;
    if(currTxt === currImg.txt.norm())
    {
      draw = function()
      {
        gData.ctx.save();
        libBackGround("red", "yellow");
        var img = currImg;
        var lineHeight = 20;
        var txt = img.txt.norm();
        gData.ctx.font = lineHeight + 'pt Calibri';
        var txtWidth = gData.ctx.measureText(txt).width;
        lineHeight *= img.width;
        lineHeight /= txtWidth;
        gData.ctx.font = lineHeight + 'pt Calibri';
        var x = cs.width / 2 - img.width / 2;
        var y = cs.height / 2 - img.height / 2 - (lineHeight + 10) / 2;
        gData.ctx.drawImage(img, x, y);
        gData.ctx.fillStyle = 'darkblue';
        gData.ctx.fillText(txt, x, y + img.height + lineHeight + 10);
        gData.ctx.restore();
      }
      onclick_ = function(e) {letterScreen(true);}
      draw();
      return;
    }
    if(currImg.txt.norm().indexOf(currTxt) != 0)
    {
      currTxt = "";
      draw = function()
      {
        gData.ctx.save();
        libBackGround("red", "yellow");
        gData.ctx.drawImage(currImg, cs.width / 2 - currImg.width / 2, cs.height / 2 - currImg.height / 2);
        gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - gData.no.height / 2);
        gData.ctx.restore();
      }
      onclick_ = function(e) {letterScreen(false);}
      draw();
      return;
    }
    draw();
  }
  draw();
}

function wordScreen(update)
{
  if(update)
  {
    var idx = Math.floor(Math.random() * 10000) % gData.length;
    currImg = gData[idx];
    var tmp = [];
    var arr = [];
    var cnt = 1;
    var txt = currImg.txt.norm();
    tmp[txt] = "";
    arr.push(txt);
    while(cnt < 3)
    {
      var txt = gData[Math.floor(Math.random() * 10000) % gData.length].txt.norm();
      if(tmp[txt] != null) continue;
      tmp[txt] = "";
      arr.push(txt);
      cnt ++;
    }
    libShuffle(arr);
    currTxtArr = arr;
  }
  draw = function()
  {
    gData.ctx.save();
    libBackGround("red", "yellow");
    var img = currImg;
    var txtWidth = 0;
    var lineHeight = img.height / 3 - 10;
    gData.ctx.font = lineHeight + 'pt Calibri';

    for(var i = 0; i < currTxtArr.length; i ++) txtWidth += gData.ctx.measureText(currTxtArr[i]).width;
    if(txtWidth > cs.width - img.width)
    {
      lineHeight *= (cs.width - img.width);
      lineHeight /= txtWidth;
      gData.ctx.font = lineHeight + 'pt Calibri';
      txtWidth = 0;
      for(var j = 0; j < currTxtArr.length; j ++) txtWidth += gData.ctx.measureText(currTxtArr[j]).width;
    }
    var x = cs.width / 2 - (img.width + txtWidth) / 2;
    var y = cs.height / 2 - img.height / 2;
    imgLeft = x;
    imgTop = y;
    gData.ctx.drawImage(img, x, y);
    x += img.width;
    y += lineHeight;
    gData.ctx.fillStyle = 'darkblue';
    txtGrid = [];
    for(var i = 0; i < currTxtArr.length; i ++)
    {
      var txt = currTxtArr[i];
      gData.ctx.fillText(txt, x, y);
      w = gData.ctx.measureText(txt).width;
      txtGrid[i] = {"x":x,"y":y,"w":w};
      x += w;
      y += (lineHeight + 10);
    }
    gData.ctx.restore();
  }
  onclick_ = function(e)
  {
    var rc = cs.getBoundingClientRect();
    var x = e.clientX - rc.left;
    var y = e.clientY - rc.top;
    if(x < imgLeft) return;
    if(y < imgTop) return;
    if(y > imgTop + currImg.height) return;
    if(x < txtGrid[0].x)
    {
      wordScreen(true);
      draw();
      return;
    }
    //in text
    var selTxt = "";
    if(x < txtGrid[1].x) selTxt = currTxtArr[0];
    else if(x < txtGrid[2].x) selTxt = currTxtArr[1];
    else selTxt = currTxtArr[2];
    if(selTxt == currImg.txt.norm())
    {
      draw = function()
      {
        gData.ctx.save();
        libBackGround("red", "yellow");
        var lineHeight = 20;
        var txt = currImg.txt.norm();
        gData.ctx.font = lineHeight + 'pt Calibri';
        var txtWidth = gData.ctx.measureText(txt).width;
        lineHeight *= currImg.width;
        lineHeight /= txtWidth;
        gData.ctx.font = lineHeight + 'pt Calibri';
        var x = cs.width / 2 - currImg.width / 2;
        var y = cs.height / 2 - currImg.height / 2 - (lineHeight + 10) / 2;
        gData.ctx.drawImage(currImg, x, y);
        gData.ctx.fillStyle = 'darkblue';
        gData.ctx.fillText(txt, x, y + currImg.height + lineHeight + 10);
        gData.ctx.restore();
      }
      onclick_ = function(e) {wordScreen(true);}
      draw();
    }
    else
    {
      draw = function()
      {
        gData.ctx.save();
        libBackGround("red", "yellow");
        gData.ctx.drawImage(currImg, cs.width / 2 - currImg.width / 2, cs.height / 2 - currImg.height / 2);
        gData.ctx.drawImage(gData.no, cs.width / 2 - gData.no.width / 2, cs.height / 2 - gData.no.height / 2);
        gData.ctx.restore();
      }
      onclick_ = function(e) {wordScreen(false);}
      draw();
    }
  }
  draw();
}

function loadingScreen()
{
  draw = function()
  {
    gData.ctx.save();
    libBackGround("green", "yellow");
    gData.ctx.font = 20 + 'pt Calibri';
    var txt = "Նկարները բեռնվում են...";
    var txtWidth = gData.ctx.measureText(txt).width;
    var x = cs.width / 2 - txtWidth / 2;
    var y = cs.height / 2;
    gData.ctx.fillStyle = 'darkblue';
    gData.ctx.fillText(txt, x, y);
    gData.ctx.restore();
  }
  draw();
}

function test0() {document.title = "Բառեր"; wordScreen(true);}
function test1() {document.title = "Տառեր"; letterScreen(true);}
function test2() {document.title = "Վանկեր"; syllableScreen(true);}
function test3() {document.title = "Թվեր"; numberScreen(true);}
function compare(mn, mx) {document.title = "Մեծ֊փոքր"; compScreen(mn, mx, true);}
function compare_num(mn, mx) {document.title = "Մեծ֊փոքր"; compScreenNum(mn, mx, true);}
function num_sound() {document.title = "Խոսող թվեր"; numSoundScreen();}

window.onload = function()
{
  cs.width = cs.parentNode.clientWidth - 30;
  cs.height = cs.parentNode.clientHeight - 30;
  gData.ctx = cs.getContext("2d");
  loadingScreen();
  gData.no = new Image("img/no-small.png");
  gData.no.src = "img/no-small.png";
  gData.refresh = new Image();
  gData.refresh.src = "img/refresh_32.png";
  for(var i = 0; i < g_vocab.length; i ++)
  {
    var img = new Image();
    img.txt = g_vocab[i].t;
    img.num = g_vocab[i].n;
    img.src = "img/"+g_vocab[i].p;
    img.onload = function(e)
    {
      e.target.onload = null;
      gData.push(e.target);
      if(gData.length == g_vocab.length) {window.onhashchange();}
    }
  }
  cs.addEventListener("mousedown", function(e) {onclick_(e);})
}

window.onhashchange = function()
{
  var entryPoint = document.URL.split("#")[1];
  if(entryPoint == undefined) entryPoint = "wordScreen(true);";
  try{eval(entryPoint);}catch(e){test0();}
}

window.onresize = function()
{
  cs.width = cs.parentNode.clientWidth - 30;
  cs.height = cs.parentNode.clientHeight - 30;
  draw();
}

</script>
<head>

<body>
<canvas id="cs" style="border:1px solid #000000">
Ձեր ծրագիրը շատ հին է, օգտագործեք Google Crome կամ Mozila Firefox
</canvas>
</body>
</html>
